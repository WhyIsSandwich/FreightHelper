import{_ as se,c as l,a as t,F as L,f as R,b as i,t as a,z as U,q as n,O as Te,r as re,h as J,n as B,s as j,w as E,v as M,g as me,i as Qe,u as Ye,x as Ke,l as y,m as K,p as We}from"./main-B_gwUFM9.js";import{C as Xe}from"./CommodityFlowSummaryModal-BowMhHdn.js";const Ze={name:"DeliveryRateDiagram",props:{stats:{type:Array,default:()=>[]}}},$e={class:"delivery-rate-diagram"},et={key:0,class:"text-center py-4 text-gray-500"},tt={key:1,class:"space-y-4"},ot={class:"flex justify-between items-center mb-2"},rt={class:"font-medium text-gray-900"},st={class:"text-sm text-gray-600"},lt={class:"delivery-bar-container"},nt={class:"delivery-bar"},it=["title"],at=["title"],dt=["title"],ct={class:"delivery-legend"},mt={class:"legend-item"},ut={class:"legend-text"},gt={class:"legend-item"},yt={class:"legend-text"},vt={class:"legend-item"},bt={class:"legend-text"};function ft(h,o,u,e,b,q){return n(),l("div",$e,[o[3]||(o[3]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Delivery Rate Progress",-1)),!u.stats||u.stats.length===0?(n(),l("div",et," No delivery data available ")):(n(),l("div",tt,[(n(!0),l(L,null,R(u.stats,g=>(n(),l("div",{key:g.commodity_type,class:"delivery-stat-item"},[t("div",ot,[t("span",rt,a(g.commodity_type),1),t("span",st," Total: "+a(g.ordered.toLocaleString()),1)]),i(" Horizontal stacked bar "),t("div",lt,[t("div",nt,[i(" Delivered (Green) "),g.delivered_percent>0?(n(),l("div",{key:0,class:"delivery-segment delivered",style:U({width:g.delivered_percent+"%"}),title:`Delivered: ${g.delivered.toLocaleString()} (${g.delivered_percent}%)`},null,12,it)):i("v-if",!0),i(" In Jobs (Yellow) "),g.in_jobs_percent>0?(n(),l("div",{key:1,class:"delivery-segment in-jobs",style:U({width:g.in_jobs_percent+"%"}),title:`In Jobs: ${g.in_jobs.toLocaleString()} (${g.in_jobs_percent}%)`},null,12,at)):i("v-if",!0),i(" Ordered (Blue) "),g.ordered_percent>0?(n(),l("div",{key:2,class:"delivery-segment ordered",style:U({width:g.ordered_percent+"%"}),title:`Ordered: ${g.ordered.toLocaleString()} (${g.ordered_percent}%)`},null,12,dt)):i("v-if",!0)])]),i(" Legend with quantities "),t("div",ct,[t("div",mt,[o[0]||(o[0]=t("div",{class:"legend-color delivered"},null,-1)),t("span",ut," Delivered: "+a(g.delivered.toLocaleString())+" ("+a(g.delivered_percent)+"%) ",1)]),t("div",gt,[o[1]||(o[1]=t("div",{class:"legend-color in-jobs"},null,-1)),t("span",yt," In Jobs: "+a(g.in_jobs.toLocaleString())+" ("+a(g.in_jobs_percent)+"%) ",1)]),t("div",vt,[o[2]||(o[2]=t("div",{class:"legend-color ordered"},null,-1)),t("span",bt," Ordered: "+a(g.ordered.toLocaleString())+" ("+a(g.ordered_percent)+"%) ",1)])])]))),128))]))])}const _t=se(Ze,[["render",ft],["__scopeId","data-v-40b458ea"],["__file","/app/src/js/components/DeliveryRateDiagram.vue"]]),xt={name:"InlineDeliveryRateBar",props:{stats:{type:Object,required:!0},debug:{type:Boolean,default:!1}},mounted(){this.debug&&console.log("🎨 [DEBUG] InlineDeliveryRateBar mounted with stats:",this.stats)},watch:{stats:{handler(h){this.debug&&console.log("🔄 [DEBUG] InlineDeliveryRateBar stats updated:",h)},deep:!0,immediate:!0}}},ht={class:"inline-delivery-rate-bar"},pt={class:"delivery-bar-container"},wt={class:"delivery-bar"},kt=["title"],Ct=["title"],St=["title"],Ot=["title"],Bt=["title"],jt={class:"delivery-legend-compact"},Dt={class:"legend-item"},Et={class:"legend-text"},Mt={class:"legend-item"},Lt={class:"legend-text"},Ft={class:"legend-item"},Gt={class:"legend-text"},It={key:0,class:"legend-item"},Vt={class:"legend-text"};function Jt(h,o,u,e,b,q){return n(),l("div",ht,[t("div",pt,[t("div",wt,[i(" Delivered (Green) "),u.stats.delivered_percent>0?(n(),l("div",{key:0,class:"delivery-segment delivered",style:U({width:u.stats.delivered_percent+"%"}),title:`Delivered: ${u.stats.delivered.toLocaleString()} (${u.stats.delivered_percent}%)`},null,12,kt)):i("v-if",!0),i(" In Jobs (Yellow) "),u.stats.in_jobs_percent>0?(n(),l("div",{key:1,class:"delivery-segment in-jobs",style:U({width:u.stats.in_jobs_percent+"%"}),title:`In Jobs: ${u.stats.in_jobs.toLocaleString()} (${u.stats.in_jobs_percent}%)`},null,12,Ct)):i("v-if",!0),i(" Ordered (Blue) "),u.stats.ordered_percent>0?(n(),l("div",{key:2,class:"delivery-segment ordered",style:U({width:u.stats.ordered_percent+"%"}),title:`Ordered: ${u.stats.ordered.toLocaleString()} (${u.stats.ordered_percent}%)`},null,12,St)):i("v-if",!0),i(" Over-allocated (Red) "),u.stats.over_allocated_percent>0?(n(),l("div",{key:3,class:"delivery-segment over-allocated",style:U({width:u.stats.over_allocated_percent+"%"}),title:`Over-allocated: ${(u.stats.over_allocated_percent/100*u.stats.ordered).toLocaleString()} (${u.stats.over_allocated_percent}%)`},null,12,Ot)):i("v-if",!0),i(" Show a full blue bar if everything is still ordered (no jobs or deliveries) "),u.stats.ordered_percent===0&&u.stats.in_jobs_percent===0&&u.stats.delivered_percent===0&&u.stats.over_allocated_percent===0&&u.stats.ordered>0&&(u.stats.in_jobs===0||u.stats.in_jobs===void 0)&&(u.stats.delivered===0||u.stats.delivered===void 0)?(n(),l("div",{key:4,class:"delivery-segment ordered",style:{width:"100%"},title:`Ordered: ${u.stats.ordered.toLocaleString()} (100%)`},null,8,Bt)):i("v-if",!0)])]),i(" Compact legend "),t("div",jt,[t("span",Dt,[o[0]||(o[0]=t("div",{class:"legend-color delivered"},null,-1)),t("span",Et,a(u.stats.delivered_percent)+"%",1)]),t("span",Mt,[o[1]||(o[1]=t("div",{class:"legend-color in-jobs"},null,-1)),t("span",Lt,a(u.stats.in_jobs_percent)+"%",1)]),t("span",Ft,[o[2]||(o[2]=t("div",{class:"legend-color ordered"},null,-1)),t("span",Gt,a(u.stats.ordered_percent)+"%",1)]),u.stats.over_allocated_percent>0?(n(),l("span",It,[o[3]||(o[3]=t("div",{class:"legend-color over-allocated"},null,-1)),t("span",Vt,a(u.stats.over_allocated_percent)+"%",1)])):i("v-if",!0)])])}const Rt=se(xt,[["render",Jt],["__scopeId","data-v-d0d80826"],["__file","/app/src/js/components/InlineDeliveryRateBar.vue"]]),Ut={name:"OrderDetails",components:{DeliveryRateDiagram:_t,InlineDeliveryRateBar:Rt,CommodityFlowSummaryModal:Xe,OCRProcessor:Te},props:{debug:{type:Boolean,default:!1}},setup(h){const o=Qe(),u=Ye(),e=Ke(),b=y(null),q=y(!0),g=y(null),W=y([]),X=y([]),s=y([]),p=y(null),v=y(!0),H=y(new Set),Z=y(new Set),P=y(new Map),N=y(new Map),$=y(!1),k=y({}),ue=y(!1),G=y(!1),ee=y(!1),te=y(!1),le=y(!1),oe=y(!1),z=y([{jobType:"Gaia",maxCargo:2e4},{jobType:"Small Batch",maxCargo:15e3}]),ne=y(!1),I=y([]),f=K(()=>o.params.orderId),ge=y("site"),C=y("name"),V=y("asc"),T=K(()=>{var d;if(!((d=b.value)!=null&&d.sites))return{};const r={};return b.value.sites.forEach(c=>{c.orderCommodities.forEach(m=>{r[m.commodity_type]||(r[m.commodity_type]=[]),r[m.commodity_type].push({site_id:c.site_id,site_name:c.site_name,type:c.type,quantity:m.quantity})})}),r}),Q=K(()=>{var d;if(!((d=b.value)!=null&&d.sites))return{};const r={};return b.value.sites.forEach(c=>{r[c.site_id]={site_name:c.site_name,site_type:c.type,commodities:c.orderCommodities.map(m=>({commodity_type:m.commodity_type,quantity:m.quantity}))}}),r}),ye=K(()=>{const r=T.value;return Object.entries(r).sort(([c,m],[_,w])=>{let x=0;if(C.value==="name")x=c.localeCompare(_);else if(C.value==="quantity"){const F=m.reduce((S,O)=>S+O.quantity,0),A=w.reduce((S,O)=>S+O.quantity,0);x=F-A}else C.value==="sites"&&(x=m.length-w.length);return V.value==="asc"?x:-x})}),ve=K(()=>{const r=Q.value;return Object.entries(r).sort(([c,m],[_,w])=>{let x=0;if(C.value==="name")x=m.site_name.localeCompare(w.site_name);else if(C.value==="quantity"){const F=m.commodities.reduce((S,O)=>S+O.quantity,0),A=w.commodities.reduce((S,O)=>S+O.quantity,0);x=F-A}else C.value==="commodities"&&(x=m.commodities.length-w.commodities.length);return V.value==="asc"?x:-x})}),be=r=>T.value[r]?T.value[r].reduce((d,c)=>d+c.quantity,0):0,ie=r=>{const d=s.value.find(c=>c.commodity_type===r);return h.debug&&(console.log(`🔍 [DEBUG] getCommodityDeliveryStats for ${r}:`,d),console.log("📊 [DEBUG] All deliveryRateStats:",s.value)),d},fe=(r,d)=>{const c=`${r}-${d}`;return P.value.get(c)||null},ae=async(r,d)=>{const c=`${r}-${d}`;if(P.value.has(c))return P.value.get(c);try{const m=await e.getDeliveryRateStatsForCommoditySite(f.value,r,d);return P.value.set(c,m),m}catch(m){return console.error("Error getting commodity-site delivery stats:",m),P.value.set(c,null),null}},_e=(r,d)=>{const c=`${r}-${d}`;return N.value.get(c)||null},de=async(r,d)=>{const c=`${r}-${d}`;if(N.value.has(c))return N.value.get(c);try{const m=await e.getDeliveryRateStatsForCommoditySite(f.value,d,r);return N.value.set(c,m),m}catch(m){return console.error("Error getting site-commodity delivery stats:",m),N.value.set(c,null),null}},xe=r=>{if(h.debug&&console.log(`🏗️ [DEBUG] getSiteDeliveryStats for site: ${r}`),!Q.value[r])return h.debug&&console.log(`❌ [DEBUG] No commodities found for site: ${r}`),null;const c=Q.value[r].commodities;h.debug&&console.log(`📦 [DEBUG] Site commodities for ${r}:`,c);const m={ordered:0,in_jobs:0,delivered:0};c.forEach(O=>{const Y=ie(O.commodity_type);h.debug&&console.log(`🔄 [DEBUG] Processing commodity ${O.commodity_type} for site ${r}:`,Y),Y&&(m.ordered+=Y.ordered,m.in_jobs+=Y.in_jobs,m.delivered+=Y.delivered)});const _=m.ordered;if(_===0)return{...m,ordered_percent:0,in_jobs_percent:0,delivered_percent:0};const w=m.delivered,x=Math.max(0,m.in_jobs-m.delivered),F=Math.max(0,m.ordered-m.in_jobs),A=Math.max(0,x+w-m.ordered),S={...m,ordered_percent:Math.round(F/_*100),in_jobs_percent:Math.round(x/_*100),delivered_percent:Math.round(w/_*100),over_allocated_percent:Math.round(A/_*100),has_over_allocation:A>0};return h.debug&&console.log(`📊 [DEBUG] Final site stats for ${r}:`,S),S},he=async r=>{if(H.value.has(r))H.value.delete(r);else{H.value.add(r);const d=T.value[r];if(d)for(const c of d)await ae(r,c.site_id)}},pe=async r=>{if(Z.value.has(r))Z.value.delete(r);else{Z.value.add(r);const d=Q.value[r];if(d&&d.commodities)for(const c of d.commodities)await de(r,c.commodity_type)}},we=r=>H.value.has(r),ke=r=>Z.value.has(r),Ce=r=>{C.value===r?V.value=V.value==="asc"?"desc":"asc":(C.value=r,V.value="asc")},Se=r=>C.value!==r?"↕":V.value==="asc"?"↑":"↓",D=async()=>{try{q.value=!0,g.value=null;const r=await e.getOrder(f.value);if(console.log("🔍 [DEBUG] Loaded order data:",r),r){b.value=r,k.value={system_name:r.system_name,client_name:r.client_name,order_value:r.order_value,start_date:r.start_date,due_date:r.due_date,external_order_id:r.external_order_id,system_distance_from_sol:r.system_distance_from_sol||0};const d=await e.getCommodityFlowSummary(f.value);W.value=d;const c=await e.getLedgerEntriesForOrder(f.value);X.value=c;const m=await e.getDeliveryRateStats(f.value);s.value=m||[];const _=await e.getOverallDeliveryRateStats(f.value);p.value=_}else g.value="Order not found"}catch(r){console.error("Error loading order:",r),g.value="Failed to load order"}finally{q.value=!1}},Oe=r=>{switch(r){case"pending":return"bg-yellow-100 text-yellow-800";case"in-progress":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Be=r=>{switch(r){case"planet":return"bg-green-100 text-green-800";case"orbital":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},je=r=>r?new Date(r).toLocaleDateString():"Not set",De=r=>r?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r):"$0.00",Ee=()=>{$.value=!0},Me=async()=>{try{const r={...b.value,system_name:k.value.system_name,client_name:k.value.client_name,order_value:k.value.order_value,start_date:k.value.start_date,due_date:k.value.due_date,external_order_id:k.value.external_order_id,system_distance_from_sol:k.value.system_distance_from_sol};await e.updateOrder(f.value,r),await D(),$.value=!1}catch(r){console.error("Error updating order:",r),alert("Failed to update order. Please try again.")}},Le=()=>{k.value={system_name:b.value.system_name,client_name:b.value.client_name,order_value:b.value.order_value,start_date:b.value.start_date,due_date:b.value.due_date,external_order_id:b.value.external_order_id,system_distance_from_sol:b.value.system_distance_from_sol||0},$.value=!1},Fe=r=>{u.push(`/order/${f.value}/site/${r}/edit`)},Ge=(r,d)=>{console.log("Edit commodity:",r,d)},Ie=async()=>{if(confirm("Are you sure you want to delete this order? This will also delete all associated jobs and cannot be undone."))try{await e.deleteOrder(f.value),window.location.href="/order"}catch(r){console.error("Error deleting order:",r),alert("Failed to delete order. Please try again.")}},Ve=async()=>{if(!ee.value&&confirm("This will remove ledger entries for jobs or sites that no longer exist in this order. Continue?")){ee.value=!0;try{const r=await e.fixLedgerEntries(f.value);alert(`Ledger cleanup completed!

Total entries: ${r.totalEntries}
Order placed entries: ${r.orderPlacedEntries} (preserved)
Job-related entries: ${r.jobRelatedEntries}
Site-related entries: ${r.siteRelatedEntries}
Orphaned entries found: ${r.orphanedEntries}
Entries removed: ${r.removedCount}
Remaining entries: ${r.remainingEntries}`),await D()}catch(r){console.error("Error fixing ledger entries:",r),alert("Failed to fix ledger entries. Please try again.")}finally{ee.value=!1}}},Je=async()=>{if(!G.value){G.value=!0;try{const r=await e.createGroundMaterialsSubcontractingJobs(f.value);r.jobs.length===0?alert(r.message):(alert(`Successfully created ${r.jobs.length} ground materials subcontracting jobs!

${r.message}`),await D())}catch(r){console.error("Error creating ground materials jobs:",r),alert("Failed to create ground materials subcontracting jobs. Please try again.")}finally{G.value=!1}}},Re=async()=>{if(!G.value){G.value=!0;try{const r=await e.createSmallBatchSubcontractingJobs(f.value);r.jobs.length===0?alert(r.message):(alert(`Successfully created ${r.jobs.length} small batch materials subcontracting jobs!

${r.message}`),await D())}catch(r){console.error("Error creating small batch jobs:",r),alert("Failed to create small batch materials subcontracting jobs. Please try again.")}finally{G.value=!1}}},Ue=async()=>{var c;if(!((c=b.value)!=null&&c.jobOrders)||b.value.jobOrders.length===0){alert("No jobs to delete.");return}const r=b.value.jobOrders.length;if(confirm(`Are you sure you want to delete ALL ${r} jobs for this order?

This action cannot be undone.`))try{const m=await e.deleteAllJobs(f.value);alert(`Successfully deleted ${m.deletedCount} jobs.`),await D()}catch(m){console.error("Error deleting all jobs:",m),alert("Failed to delete all jobs. Please try again.")}},qe=async()=>{if(!te.value&&confirm(`Are you sure you want to complete this order?

This will mark the order as completed and cannot be undone.`)){te.value=!0;try{await e.completeOrder(f.value),alert("Order completed successfully!"),await D()}catch(r){console.error("Error completing order:",r),alert("Failed to complete order. Please try again.")}finally{te.value=!1}}},Ae=()=>{z.value.push({jobType:"",maxCargo:2e4})},He=r=>{z.value.length>1&&z.value.splice(r,1)},Pe=async()=>{if(oe.value)return;const r=z.value.filter(d=>d.jobType.trim()&&d.maxCargo>0);if(r.length===0){alert("Please enter at least one valid job type and max cargo.");return}oe.value=!0;try{const d=r.map(_=>_.jobType.trim()),c=r.map(_=>_.maxCargo),m=await e.createBulkOrders(f.value,d,c);m.jobs.length===0?alert(m.message):(alert(`Successfully created ${m.jobs.length} bulk orders!

${m.message}`),await D(),le.value=!1)}catch(d){console.error("Error creating bulk orders:",d),alert("Failed to create bulk orders. Please try again.")}finally{oe.value=!1}},Ne=async r=>{try{console.log("🔍 [DEBUG] Handling bulk site import:",r);const d=Array.isArray(r)?r:r.commodities,c=Array.isArray(r)?null:r.siteInfo;if(!d||d.length===0){console.log("🔍 [DEBUG] No commodities found in this emission, skipping");return}const m=`site_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;let _="Imported Site",w="orbital";c&&(c.name&&(_=c.name),c.isPlanetary!==null&&(w=c.isPlanetary?"planet":"orbital"));const x={site_id:m,site_name:_,type:w,orderCommodities:d.map(F=>({commodity_type:F.name,quantity:F.quantity}))};I.value.push(x),console.log(`🔍 [DEBUG] Added site "${_}" to pending sites. Total pending: ${I.value.length}`)}catch(d){console.error("Error processing site import:",d),alert("Failed to process site import. Please try again.")}},ce=async()=>{var r;if(I.value.length!==0)try{console.log(`🔍 [DEBUG] Processing ${I.value.length} pending sites`),await e.updateOrder(f.value,{sites:[...((r=b.value)==null?void 0:r.sites)||[],...I.value]}),alert(`Successfully imported ${I.value.length} sites with commodities!`),await D(),I.value=[]}catch(d){console.error("Error importing sites:",d),alert("Failed to import sites. Please try again.")}},ze=async()=>{ne.value=!1,await ce()};return We(()=>{D()}),{order:b,loading:q,error:g,commodityFlowSummary:W,ledgerEntries:X,deliveryRateStats:s,overallDeliveryStats:p,showOverallSummary:v,showFlowSummaryModal:ue,orderId:f,summaryGroupBy:ge,summaryGroupedByCommodity:T,summaryGroupedBySite:Q,sortedCommodityGroups:ye,sortedSiteGroups:ve,sortBy:C,sortOrder:V,getTotalQuantityForCommodity:be,getCommodityDeliveryStats:ie,getCommoditySiteDeliveryStats:fe,loadCommoditySiteDeliveryStats:ae,getSiteCommodityDeliveryStats:_e,loadSiteCommodityDeliveryStats:de,getSiteDeliveryStats:xe,toggleCommodityExpansion:he,toggleSiteExpansion:pe,isCommodityExpanded:we,isSiteExpanded:ke,setSortBy:Ce,getSortIcon:Se,getStatusClass:Oe,getSiteTypeClass:Be,formatDate:je,formatCurrency:De,isEditingOrder:$,editableOrder:k,startEditingOrder:Ee,saveOrderChanges:Me,cancelEditingOrder:Le,editSite:Fe,editSiteCommodity:Ge,confirmDeleteOrder:Ie,isCreatingJobs:G,createGroundMaterialsJobs:Je,createSmallBatchJobs:Re,confirmDeleteAllJobs:Ue,isFixingLedger:ee,fixLedgerEntries:Ve,isCompletingOrder:te,completeOrder:qe,showBulkOrderModal:le,isCreatingBulkOrders:oe,bulkOrderItems:z,addBulkOrderItem:Ae,removeBulkOrderItem:He,createBulkOrders:Pe,showBulkSiteImportModal:ne,handleBulkSiteImport:Ne,handleModalClose:ze,processPendingSites:ce}}},qt={class:"order-details"},At={key:0,class:"flex justify-center items-center h-64"},Ht={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"},Pt={key:2,class:"space-y-6"},Nt={class:"bg-white rounded-lg p-6 shadow-md"},zt={class:"flex justify-between items-start mb-4"},Tt={class:"flex items-center gap-3 mb-2"},Qt={class:"text-3xl font-bold text-gray-900"},Yt={class:"text-gray-600 mt-1"},Kt={class:"text-right"},Wt={class:"flex items-center gap-2 mb-2"},Xt=["disabled"],Zt={key:0},$t={key:1},eo=["disabled"],to={key:0},oo={key:1},ro={key:2},so={class:"text-sm text-gray-600"},lo={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},no={key:0,class:"text-lg font-semibold text-gray-900"},io={key:0,class:"text-lg font-semibold text-gray-900"},ao={key:0,class:"text-lg font-semibold text-gray-900"},co={key:0,class:"text-lg font-semibold text-gray-900"},mo={key:0,class:"text-lg font-semibold text-gray-900"},uo={key:0,class:"text-lg font-semibold text-gray-900"},go={key:0,class:"text-lg font-semibold text-gray-900"},yo={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},vo={class:"bg-white rounded-lg p-6 shadow-md"},bo={class:"flex justify-between items-center mb-4"},fo={class:"flex gap-2"},_o={key:0,class:"mb-6 border rounded-lg overflow-hidden"},xo={class:"flex justify-between items-center"},ho={class:"flex items-center gap-2"},po={class:"text-xs text-gray-600"},wo={class:"text-sm text-gray-600"},ko={key:1,class:"space-y-4"},Co={class:"flex gap-2 mb-4 p-3 bg-gray-50 rounded-lg"},So=["onClick"],Oo={class:"flex justify-between items-center mb-2"},Bo={class:"flex items-center gap-2"},jo={class:"text-xs text-gray-600"},Do={class:"font-medium text-gray-900"},Eo={class:"text-sm text-gray-600"},Mo={key:0},Lo={key:0,class:"divide-y"},Fo={class:"flex justify-between items-center mb-2"},Go={class:"font-medium"},Io={class:"text-sm text-gray-500 ml-2"},Vo={class:"font-mono text-gray-600"},Jo={key:0},Ro={class:"space-y-4"},Uo={class:"flex gap-2 mb-4 p-3 bg-gray-50 rounded-lg"},qo={class:"bg-gray-50 px-4 py-2 border-b"},Ao={class:"flex justify-between items-center mb-2"},Ho={class:"flex items-center gap-2"},Po=["onClick"],No={class:"font-medium text-gray-900"},zo={class:"text-sm text-gray-600"},To=["onClick"],Qo={key:0},Yo={key:0,class:"divide-y"},Ko={class:"flex justify-between items-center mb-2"},Wo={class:"font-medium"},Xo={class:"flex items-center gap-2"},Zo={class:"font-mono text-gray-600"},$o=["onClick"],er={key:0},tr={class:"bg-white rounded-lg p-6 shadow-md"},or={class:"mb-6 p-4 bg-gray-50 rounded-lg border"},rr={class:"flex gap-2 flex-wrap"},sr=["disabled"],lr={key:0,class:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24"},nr={key:1,class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ir=["disabled"],ar={key:0,class:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24"},dr={key:1,class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},cr=["disabled"],mr={key:0,class:"space-y-2"},ur=["onClick"],gr={class:"p-3"},yr={class:"flex justify-between items-start mb-2"},vr={class:"flex-1 min-w-0"},br={class:"text-sm font-medium text-gray-900 truncate"},fr={class:"text-xs text-gray-500 mt-0.5"},_r={class:"flex items-center gap-2 ml-2"},xr={class:"flex justify-between items-center text-xs text-gray-600"},hr={class:"flex items-center gap-3"},pr={key:0},wr={key:1,class:"truncate max-w-32"},kr={key:0,class:"font-mono text-gray-700"},Cr={key:1,class:"text-center py-8 text-gray-500"},Sr={key:0,class:"bg-white rounded-lg p-4 shadow-md"},Or={class:"flex items-center justify-between"},Br={class:"text-sm text-gray-600"},jr={class:"bg-white rounded-lg p-6 w-full max-w-6xl max-h-[90vh] overflow-y-auto"},Dr={class:"flex justify-between items-center mb-4"},Er={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white"},Mr={class:"mt-3"},Lr={class:"flex items-center justify-between mb-4"},Fr={class:"space-y-4"},Gr=["onUpdate:modelValue"],Ir=["onUpdate:modelValue"],Vr=["onClick","disabled"],Jr={class:"flex justify-end gap-3 mt-6"},Rr=["disabled"],Ur={key:0},qr={key:1};function Ar(h,o,u,e,b,q){const g=re("InlineDeliveryRateBar"),W=re("CommodityFlowSummaryModal"),X=re("OCRProcessor");return n(),l(L,null,[t("div",qt,[e.loading?(n(),l("div",At,o[39]||(o[39]=[t("div",{class:"text-gray-600"},"Loading order...",-1)]))):e.error?(n(),l("div",Ht,a(e.error),1)):e.order?(n(),l("div",Pt,[i(" Order Header "),t("div",Nt,[t("div",zt,[t("div",null,[t("div",Tt,[t("button",{onClick:o[0]||(o[0]=s=>h.$router.push("/order")),class:"text-gray-600 hover:text-gray-800 transition-colors"}," ← Back to Orders ")]),t("h1",Qt,a(e.order.client_name),1),t("p",Yt,"Order ID: "+a(e.order.order_id),1)]),t("div",Kt,[t("div",Wt,[t("span",{class:B(["px-3 py-1 text-sm rounded-full font-medium",e.getStatusClass(e.order.status)])},a(e.order.status),3),e.isEditingOrder?i("v-if",!0):(n(),l("button",{key:0,onClick:o[1]||(o[1]=(...s)=>e.startEditingOrder&&e.startEditingOrder(...s)),class:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors flex items-center gap-1"},o[40]||(o[40]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),j(" Edit Order ")]))),e.isEditingOrder?(n(),l("button",{key:1,onClick:o[2]||(o[2]=(...s)=>e.saveOrderChanges&&e.saveOrderChanges(...s)),class:"px-3 py-1 text-sm bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors flex items-center gap-1"},o[41]||(o[41]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})],-1),j(" Save ")]))):i("v-if",!0),e.isEditingOrder?(n(),l("button",{key:2,onClick:o[3]||(o[3]=(...s)=>e.cancelEditingOrder&&e.cancelEditingOrder(...s)),class:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors"}," Cancel ")):i("v-if",!0),t("button",{onClick:o[4]||(o[4]=(...s)=>e.fixLedgerEntries&&e.fixLedgerEntries(...s)),disabled:e.isFixingLedger,class:"px-3 py-1 text-sm bg-yellow-100 text-yellow-700 rounded hover:bg-yellow-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[e.isFixingLedger?(n(),l("span",Zt,"Fixing...")):(n(),l("span",$t,"Fix Ledger"))],8,Xt),t("button",{onClick:o[5]||(o[5]=(...s)=>e.completeOrder&&e.completeOrder(...s)),disabled:e.order.status==="completed"||e.isCompletingOrder,class:"px-3 py-1 text-sm bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[e.isCompletingOrder?(n(),l("span",to,"Completing...")):e.order.status==="completed"?(n(),l("span",oo,"Completed")):(n(),l("span",ro,"Complete Order"))],8,eo),t("button",{onClick:o[6]||(o[6]=(...s)=>e.confirmDeleteOrder&&e.confirmDeleteOrder(...s)),class:"px-3 py-1 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors"}," Delete Order ")]),t("p",so," Created: "+a(e.formatDate(e.order.created_at)),1)])]),i(" Order Information "),t("div",lo,[t("div",null,[o[42]||(o[42]=t("h3",{class:"text-sm font-medium text-gray-700 mb-1"},"Client Name",-1)),e.isEditingOrder?E((n(),l("input",{key:1,"onUpdate:modelValue":o[7]||(o[7]=s=>e.editableOrder.client_name=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512)),[[M,e.editableOrder.client_name]]):(n(),l("div",no,a(e.order.client_name),1))]),t("div",null,[o[43]||(o[43]=t("h3",{class:"text-sm font-medium text-gray-700 mb-1"},"System",-1)),e.isEditingOrder?E((n(),l("input",{key:1,"onUpdate:modelValue":o[8]||(o[8]=s=>e.editableOrder.system_name=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512)),[[M,e.editableOrder.system_name]]):(n(),l("div",io,a(e.order.system_name),1))]),t("div",null,[o[44]||(o[44]=t("h3",{class:"text-sm font-medium text-gray-700 mb-1"},"External Order ID",-1)),e.isEditingOrder?E((n(),l("input",{key:1,"onUpdate:modelValue":o[9]||(o[9]=s=>e.editableOrder.external_order_id=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512)),[[M,e.editableOrder.external_order_id]]):(n(),l("div",ao,a(e.order.external_order_id||"Not set"),1))]),t("div",null,[o[45]||(o[45]=t("h3",{class:"text-sm font-medium text-gray-700 mb-1"},"Order Value",-1)),e.isEditingOrder?E((n(),l("input",{key:1,"onUpdate:modelValue":o[10]||(o[10]=s=>e.editableOrder.order_value=s),type:"number",min:"0",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512)),[[M,e.editableOrder.order_value,void 0,{number:!0}]]):(n(),l("div",co,a(e.formatCurrency(e.order.order_value)),1))]),t("div",null,[o[46]||(o[46]=t("h3",{class:"text-sm font-medium text-gray-700 mb-1"},"Start Date",-1)),e.isEditingOrder?E((n(),l("input",{key:1,"onUpdate:modelValue":o[11]||(o[11]=s=>e.editableOrder.start_date=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512)),[[M,e.editableOrder.start_date]]):(n(),l("div",mo,a(e.order.start_date?e.formatDate(e.order.start_date):"Not set"),1))]),t("div",null,[o[47]||(o[47]=t("h3",{class:"text-sm font-medium text-gray-700 mb-1"},"Due Date",-1)),e.isEditingOrder?E((n(),l("input",{key:1,"onUpdate:modelValue":o[12]||(o[12]=s=>e.editableOrder.due_date=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512)),[[M,e.editableOrder.due_date]]):(n(),l("div",uo,a(e.order.due_date?e.formatDate(e.order.due_date):"Not set"),1))]),t("div",null,[o[48]||(o[48]=t("h3",{class:"text-sm font-medium text-gray-700 mb-1"}," Distance from Sol (LY) ",-1)),e.isEditingOrder?E((n(),l("input",{key:1,"onUpdate:modelValue":o[13]||(o[13]=s=>e.editableOrder.system_distance_from_sol=s),type:"number",min:"0",step:"0.1",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512)),[[M,e.editableOrder.system_distance_from_sol,void 0,{number:!0}]]):(n(),l("div",go,a(e.order.system_distance_from_sol||0),1))])])]),i(" Two Column Layout: Order Summary and Jobs "),t("div",yo,[i(" Order Summary Column "),t("div",vo,[t("div",bo,[o[51]||(o[51]=t("h2",{class:"text-xl font-semibold text-gray-900"},"Order Summary",-1)),t("div",fo,[t("button",{onClick:o[14]||(o[14]=s=>{e.summaryGroupBy="commodity",e.showOverallSummary=!0}),class:B(["px-3 py-1 text-sm rounded",e.summaryGroupBy==="commodity"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"])}," Group by Commodity ",2),t("button",{onClick:o[15]||(o[15]=s=>{e.summaryGroupBy="site",e.showOverallSummary=!0}),class:B(["px-3 py-1 text-sm rounded",e.summaryGroupBy==="site"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"])}," Group by Site ",2),t("button",{onClick:o[16]||(o[16]=s=>h.$router.push(`/order/${e.orderId}/site/new`)),class:"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700 transition-colors flex items-center gap-1"},o[49]||(o[49]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),j(" Add Site ")])),t("button",{onClick:o[17]||(o[17]=s=>e.showBulkSiteImportModal=!0),class:"px-3 py-1 text-sm bg-indigo-600 text-white rounded hover:bg-indigo-700 transition-colors flex items-center gap-1",title:"Import multiple sites with commodities from OCR images"},o[50]||(o[50]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})],-1),j(" Import Sites ")]))])]),i(" Overall Delivery Rate Summary "),e.overallDeliveryStats?(n(),l("div",_o,[t("div",{onClick:o[18]||(o[18]=s=>e.showOverallSummary=!e.showOverallSummary),class:"p-4 bg-gray-50 cursor-pointer hover:bg-gray-100 transition-colors"},[t("div",xo,[t("div",ho,[t("span",po,a(e.showOverallSummary?"▼":"▶"),1),o[52]||(o[52]=t("h3",{class:"text-lg font-medium text-gray-900"}," Overall Delivery Progress ",-1))]),t("div",wo," Total: "+a((e.overallDeliveryStats.ordered||0).toLocaleString())+" units ",1)]),J(g,{stats:e.overallDeliveryStats},null,8,["stats"])])])):i("v-if",!0),i(" Commodity Grouped View "),e.summaryGroupBy==="commodity"&&e.showOverallSummary?(n(),l("div",ko,[i(" Sort Controls for Commodity View "),t("div",Co,[o[53]||(o[53]=t("span",{class:"text-sm font-medium text-gray-700"},"Sort by:",-1)),t("button",{onClick:o[19]||(o[19]=s=>e.setSortBy("name")),class:B(["px-3 py-1 text-sm rounded border hover:bg-gray-100 transition-colors flex items-center gap-1",e.sortBy==="name"?"bg-blue-100 text-blue-700 border-blue-300":"bg-white text-gray-700 border-gray-300"])}," Name "+a(e.getSortIcon("name")),3),t("button",{onClick:o[20]||(o[20]=s=>e.setSortBy("quantity")),class:B(["px-3 py-1 text-sm rounded border hover:bg-gray-100 transition-colors flex items-center gap-1",e.sortBy==="quantity"?"bg-blue-100 text-blue-700 border-blue-300":"bg-white text-gray-700 border-gray-300"])}," Total Quantity "+a(e.getSortIcon("quantity")),3),t("button",{onClick:o[21]||(o[21]=s=>e.setSortBy("sites")),class:B(["px-3 py-1 text-sm rounded border hover:bg-gray-100 transition-colors flex items-center gap-1",e.sortBy==="sites"?"bg-blue-100 text-blue-700 border-blue-300":"bg-white text-gray-700 border-gray-300"])}," Sites Count "+a(e.getSortIcon("sites")),3)]),(n(!0),l(L,null,R(e.sortedCommodityGroups,([s,p])=>(n(),l("div",{key:s,class:"border rounded-lg overflow-hidden"},[t("div",{onClick:v=>e.toggleCommodityExpansion(s),class:"bg-gray-50 px-4 py-2 border-b cursor-pointer hover:bg-gray-100 transition-colors"},[t("div",Oo,[t("div",Bo,[t("span",jo,a(e.isCommodityExpanded(s)?"▼":"▶"),1),t("div",null,[t("h4",Do,a(s),1),t("p",Eo," Total: "+a(e.getTotalQuantityForCommodity(s).toLocaleString()),1)])])]),i(" Delivery Rate Bar for Commodity "),e.getCommodityDeliveryStats(s)?(n(),l("div",Mo,[J(g,{stats:e.getCommodityDeliveryStats(s)},null,8,["stats"])])):i("v-if",!0)],8,So),e.isCommodityExpanded(s)?(n(),l("div",Lo,[(n(!0),l(L,null,R(p,v=>(n(),l("div",{key:`${s}-${v.site_id}`,class:"px-4 py-3"},[t("div",Fo,[t("div",null,[t("span",Go,a(v.site_name),1),t("span",Io,"("+a(v.type)+")",1)]),t("span",Vo,a(v.quantity.toLocaleString()),1)]),i(" Delivery Rate Bar for Site-Commodity "),e.getCommoditySiteDeliveryStats(s,v.site_id)?(n(),l("div",Jo,[J(g,{stats:e.getCommoditySiteDeliveryStats(s,v.site_id)},null,8,["stats"])])):i("v-if",!0)]))),128))])):i("v-if",!0)]))),128))])):e.summaryGroupBy==="site"&&e.showOverallSummary?(n(),l(L,{key:2},[i(" Site Grouped View "),t("div",Ro,[i(" Sort Controls for Site View "),t("div",Uo,[o[54]||(o[54]=t("span",{class:"text-sm font-medium text-gray-700"},"Sort by:",-1)),t("button",{onClick:o[22]||(o[22]=s=>e.setSortBy("name")),class:B(["px-3 py-1 text-sm rounded border hover:bg-gray-100 transition-colors flex items-center gap-1",e.sortBy==="name"?"bg-blue-100 text-blue-700 border-blue-300":"bg-white text-gray-700 border-gray-300"])}," Name "+a(e.getSortIcon("name")),3),t("button",{onClick:o[23]||(o[23]=s=>e.setSortBy("quantity")),class:B(["px-3 py-1 text-sm rounded border hover:bg-gray-100 transition-colors flex items-center gap-1",e.sortBy==="quantity"?"bg-blue-100 text-blue-700 border-blue-300":"bg-white text-gray-700 border-gray-300"])}," Total Quantity "+a(e.getSortIcon("quantity")),3),t("button",{onClick:o[24]||(o[24]=s=>e.setSortBy("commodities")),class:B(["px-3 py-1 text-sm rounded border hover:bg-gray-100 transition-colors flex items-center gap-1",e.sortBy==="commodities"?"bg-blue-100 text-blue-700 border-blue-300":"bg-white text-gray-700 border-gray-300"])}," Commodities Count "+a(e.getSortIcon("commodities")),3)]),(n(!0),l(L,null,R(e.sortedSiteGroups,([s,p])=>(n(),l("div",{key:s,class:"border rounded-lg overflow-hidden"},[t("div",qo,[t("div",Ao,[t("div",Ho,[t("span",{onClick:v=>e.toggleSiteExpansion(s),class:"text-xs text-gray-600 cursor-pointer hover:text-gray-800"},a(e.isSiteExpanded(s)?"▼":"▶"),9,Po),t("div",null,[t("h4",No,a(p.site_name),1),t("p",zo,a(p.commodities.length)+" commodity type"+a(p.commodities.length!==1?"s":""),1)])]),t("button",{onClick:v=>e.editSite(s),class:"p-1 text-gray-400 hover:text-blue-600 transition-colors",title:"Edit site"},[...o[55]||(o[55]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,To)]),i(" Delivery Rate Bar for Site (aggregated) "),e.getSiteDeliveryStats(s)?(n(),l("div",Qo,[J(g,{stats:e.getSiteDeliveryStats(s)},null,8,["stats"])])):i("v-if",!0)]),e.isSiteExpanded(s)?(n(),l("div",Yo,[(n(!0),l(L,null,R(p.commodities,v=>(n(),l("div",{key:`${s}-${v.commodity_type}`,class:"px-4 py-3"},[t("div",Ko,[t("span",Wo,a(v.commodity_type),1),t("div",Xo,[t("span",Zo,a(v.quantity.toLocaleString()),1),t("button",{onClick:H=>e.editSiteCommodity(s,v.commodity_type),class:"p-1 text-gray-400 hover:text-blue-600 transition-colors",title:"Edit commodity"},[...o[56]||(o[56]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,$o)])]),i(" Delivery Rate Bar for Site-Commodity "),e.getSiteCommodityDeliveryStats(s,v.commodity_type)?(n(),l("div",er,[J(g,{stats:e.getSiteCommodityDeliveryStats(s,v.commodity_type)},null,8,["stats"])])):i("v-if",!0)]))),128))])):i("v-if",!0)]))),128))])],2112)):i("v-if",!0)]),i(" Jobs Column "),t("div",tr,[o[64]||(o[64]=t("div",{class:"flex justify-between items-center mb-4"},[t("h2",{class:"text-xl font-semibold text-gray-900"},"Jobs")],-1)),i(" Quick Subcontracting Actions "),t("div",or,[t("div",rr,[t("button",{onClick:o[25]||(o[25]=s=>h.$router.push(`/order/${e.orderId}/jobs/new`)),class:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center gap-2 text-sm",title:"Create a new job manually"},o[57]||(o[57]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),j(" Create Job ")])),t("button",{onClick:o[26]||(o[26]=(...s)=>e.createGroundMaterialsJobs&&e.createGroundMaterialsJobs(...s)),disabled:e.isCreatingJobs,class:"px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 text-sm",title:"Create subcontracting jobs for ground materials with optimized batching (max 20k commodities, preferred 10k batches)"},[e.isCreatingJobs?(n(),l("svg",lr,o[58]||(o[58]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(n(),l("svg",nr,o[59]||(o[59]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"},null,-1)]))),j(" "+a(e.isCreatingJobs?"Creating...":"Ground Materials"),1)],8,sr),t("button",{onClick:o[27]||(o[27]=(...s)=>e.createSmallBatchJobs&&e.createSmallBatchJobs(...s)),disabled:e.isCreatingJobs,class:"px-3 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 text-sm",title:"Create subcontracting jobs for small batch materials with optimized batching"},[e.isCreatingJobs?(n(),l("svg",ar,o[60]||(o[60]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(n(),l("svg",dr,o[61]||(o[61]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"},null,-1)]))),j(" "+a(e.isCreatingJobs?"Creating...":"Small Batch"),1)],8,ir),t("button",{onClick:o[28]||(o[28]=s=>e.showBulkOrderModal=!0),class:"px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors flex items-center gap-2 text-sm",title:"Create bulk orders with custom job types and cargo limits"},o[62]||(o[62]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})],-1),j(" Bulk Orders ")])),t("button",{onClick:o[29]||(o[29]=(...s)=>e.confirmDeleteAllJobs&&e.confirmDeleteAllJobs(...s)),disabled:!e.order.jobOrders||e.order.jobOrders.length===0,class:"px-3 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 text-sm",title:"Delete all jobs for this order (cannot be undone)"},o[63]||(o[63]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),j(" Delete All ")]),8,cr)])]),e.order.jobOrders&&e.order.jobOrders.length>0?(n(),l("div",mr,[(n(!0),l(L,null,R(e.order.jobOrders,s=>(n(),l("div",{key:s.job_id,class:"bg-white rounded border border-gray-200 hover:border-gray-300 hover:shadow-sm transition-all cursor-pointer",onClick:p=>h.$router.push(`/order/${e.orderId}/jobs/${s.job_id}`)},[t("div",gr,[t("div",yr,[t("div",vr,[t("h3",br,a(s.job_name||"Unnamed Job"),1),t("p",fr,a(s.job_type)+" • "+a(e.formatDate(s.created_at)),1)]),t("div",_r,[t("span",{class:B(["px-2 py-1 text-xs rounded-full font-medium",e.getStatusClass(s.status)])},a(s.status),3)])]),t("div",xr,[t("div",hr,[s.commodities&&s.commodities.length>0?(n(),l("span",pr,a(s.commodities.length)+" type"+a(s.commodities.length!==1?"s":"")+" ("+a(s.commodities.reduce((p,v)=>p+v.quantity,0).toLocaleString())+") ",1)):i("v-if",!0),s.contractor_fleet_carrier||s.subcontractor_jobId?(n(),l("span",wr,a(s.contractor_fleet_carrier||s.subcontractor_jobId),1)):i("v-if",!0)]),s.job_cost?(n(),l("span",kr,a(s.job_cost.toLocaleString())+" Cr ",1)):i("v-if",!0)])])],8,ur))),128))])):(n(),l("div",Cr,' No jobs created yet. Click "Create Job" to get started. '))])]),i(" Commodity Flow Summary Button "),e.commodityFlowSummary.length>0?(n(),l("div",Sr,[t("div",Or,[t("div",null,[o[65]||(o[65]=t("h3",{class:"text-lg font-medium text-gray-900"},"Commodity Flow Summary",-1)),t("p",Br," View detailed flow data for "+a(e.commodityFlowSummary.length)+" entries ",1)]),t("button",{onClick:o[30]||(o[30]=s=>e.showFlowSummaryModal=!0),class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},o[66]||(o[66]=[t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),j(" View Summary ")]))])])):i("v-if",!0)])):i("v-if",!0)]),i(" Commodity Flow Summary Modal "),J(W,{"is-open":e.showFlowSummaryModal,"flow-summary":e.commodityFlowSummary,"ledger-entries":e.ledgerEntries,onClose:o[31]||(o[31]=s=>e.showFlowSummaryModal=!1)},null,8,["is-open","flow-summary","ledger-entries"]),i(" Bulk Site Import Modal "),e.showBulkSiteImportModal?(n(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:o[33]||(o[33]=me((...s)=>e.handleModalClose&&e.handleModalClose(...s),["self"]))},[t("div",jr,[t("div",Dr,[o[68]||(o[68]=t("h3",{class:"text-xl font-semibold"},"Import Sites from OCR",-1)),t("button",{onClick:o[32]||(o[32]=(...s)=>e.handleModalClose&&e.handleModalClose(...s)),class:"text-gray-500 hover:text-gray-700"},o[67]||(o[67]=[t("span",{class:"text-2xl"},"×",-1)]))]),J(X,{"quote-id":e.orderId,onCommoditiesExtracted:e.handleBulkSiteImport},null,8,["quote-id","onCommoditiesExtracted"])])])):i("v-if",!0),i(" Bulk Order Creation Modal "),e.showBulkOrderModal?(n(),l("div",{key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:o[38]||(o[38]=me(s=>e.showBulkOrderModal=!1,["self"]))},[t("div",Er,[t("div",Mr,[t("div",Lr,[o[70]||(o[70]=t("h3",{class:"text-lg font-medium text-gray-900"},"Create Bulk Orders",-1)),t("button",{onClick:o[34]||(o[34]=s=>e.showBulkOrderModal=!1),class:"text-gray-400 hover:text-gray-600"},o[69]||(o[69]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",Fr,[t("div",null,[o[71]||(o[71]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Job Types and Max Cargo ",-1)),o[72]||(o[72]=t("p",{class:"text-sm text-gray-600 mb-3"}," Enter job types and their maximum cargo limits. The system will create jobs using as few sites as possible. ",-1)),(n(!0),l(L,null,R(e.bulkOrderItems,(s,p)=>(n(),l("div",{key:p,class:"flex gap-2 mb-2"},[E(t("input",{"onUpdate:modelValue":v=>s.jobType=v,type:"text",placeholder:"Job Type (e.g., Gaia, Small Batch)",class:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,Gr),[[M,s.jobType]]),E(t("input",{"onUpdate:modelValue":v=>s.maxCargo=v,type:"number",min:"1",placeholder:"Max Cargo",class:"w-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,Ir),[[M,s.maxCargo,void 0,{number:!0}]]),t("button",{onClick:v=>e.removeBulkOrderItem(p),class:"px-3 py-2 bg-red-100 text-red-700 rounded-md hover:bg-red-200 transition-colors",disabled:e.bulkOrderItems.length<=1}," Remove ",8,Vr)]))),128)),t("button",{onClick:o[35]||(o[35]=(...s)=>e.addBulkOrderItem&&e.addBulkOrderItem(...s)),class:"px-3 py-2 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors"}," Add Job Type ")])]),t("div",Jr,[t("button",{onClick:o[36]||(o[36]=s=>e.showBulkOrderModal=!1),class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors"}," Cancel "),t("button",{onClick:o[37]||(o[37]=(...s)=>e.createBulkOrders&&e.createBulkOrders(...s)),disabled:e.isCreatingBulkOrders||e.bulkOrderItems.length===0,class:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[e.isCreatingBulkOrders?(n(),l("span",Ur,"Creating...")):(n(),l("span",qr,"Create Bulk Orders"))],8,Rr)])])])])):i("v-if",!0)],64)}const Nr=se(Ut,[["render",Ar],["__scopeId","data-v-576009f3"],["__file","/app/src/js/components/OrderDetails.vue"]]);export{Nr as default};
